repos:
  - repo: https://github.com/sqlfluff/sqlfluff
    rev: 3.1.1
    hooks:
      - id: sqlfluff-lint
        additional_dependencies:
          [dbt-snowflake==1.8.3, sqlfluff-templater-dbt==3.1.1]
      - id: sqlfluff-fix
        stages: [manual]
        additional_dependencies:
          [dbt-snowflake==1.8.3, sqlfluff-templater-dbt==3.1.1]

  - repo: https://github.com/dbt-checkpoint/dbt-checkpoint
    rev: v2.0.3
    hooks:
      #- id: dbt-compile # Compiles dbt (necessary for future hooks)
      #  args: [--exclude, macros, --]
      #- id: dbt-docs-generate # Generates the dbt docs (necessary for some future hooks)
      - id: check-source-table-has-description # Ensures all source tables have descriptions
      - id: check-model-has-tests # Ensures all models have at least 2 tests
        args: [--test-cnt, "2", --]
        files: ^models/
      - id: check-script-semicolon # Ensure that the model does not have a semicolon at the end of the file.
      - id: check-script-has-no-table-name # Ensures models only use source or ref macro to specify the table name.
      #- id: check-model-has-all-columns # Ensures that mart models have all columns in the database also specified in the .yml
      #  files: ^models/marts
